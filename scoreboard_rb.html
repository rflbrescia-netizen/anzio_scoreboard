<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pro Scoreboard – Overlay (Firebase)</title>
  <style>
    :root{
      --card:#0b0f14; --accent:#5ee0ff; --accent2:#80ff9f; --muted:#8a93a6; --danger:#ff5470; --amber:#ffcc4d; --white:#f5f7fb;
    }
    html,body{height:100%;margin:0;background:transparent;color:var(--white);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Arial,sans-serif}
    .bar-wrap{ position:fixed; left:50%; bottom:0; transform:translateX(-50%); width:1920px; height:80px; pointer-events:none; }
    .scorebar{ width:100%; height:100%; border-radius:14px 14px 0 0; backdrop-filter: blur(8px);
      background: linear-gradient(135deg, rgba(20,25,35,.92), rgba(11,15,20,.92));
      box-shadow: 0 -8px 40px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.06);
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:center; padding:8px 12px; box-sizing:border-box; }
    .team{ display:grid; grid-template-columns: 56px 1fr 72px 110px; grid-template-areas:"logo name score meta"; gap:8px; align-items:center; }
    .team.right{ grid-template-columns:110px 72px 1fr 56px; grid-template-areas:"meta score name logo"; justify-items:end; }
    .logo{ grid-area:logo; width:56px; height:56px; border-radius:10px; overflow:hidden; background:#1b2431; display:grid; place-items:center; box-shadow:inset 0 0 0 1px rgba(255,255,255,.06)}
    .logo img{ width:100%; height:100%; object-fit:cover }
    .name{ grid-area:name; font-weight:900; letter-spacing:.5px; text-transform:uppercase; color:var(--white); opacity:.95; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; font-size:18px }
    .score{ grid-area:score; font-weight:900; font-size:36px; line-height:1; letter-spacing:.5px; display:flex; align-items:center; justify-content:center;
      padding:2px 8px; border-radius:12px; min-width:72px; background:radial-gradient(100px 50px at 50% -10%, rgba(94,224,255,.28), transparent 70%), rgba(255,255,255,.06);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.08) }
    .meta{ grid-area:meta; display:flex; align-items:center; gap:6px; color:var(--muted); font-weight:700 }
    .pill{ font-size:11px; padding:4px 8px; border-radius:999px; background:rgba(255,255,255,.06); box-shadow:inset 0 0 0 1px rgba(255,255,255,.08); display:flex; align-items:center; gap:6px }
    .dot{ width:7px; height:7px; border-radius:50%; background:var(--muted); box-shadow:0 0 7px currentColor }
    .dot.bonus{ background:var(--accent2) } .dot.foul{ background:var(--danger) } .dot.poss{ background:var(--amber) }
    .center{ position:relative; display:grid; gap:4px; align-items:center; justify-items:center; padding:0 12px; min-width:260px }
    .clock{ font-weight:900; font-size:38px; letter-spacing:1px; line-height:1 }
    .center-meta{ display:flex; gap:8px; align-items:center }
    .label{ font-size:11px; color:var(--muted); text-transform:uppercase; letter-spacing:.6px }
    .value{ font-weight:800; font-size:12px }
  </style>
</head>
<body>
  <div class="bar-wrap">
    <article class="scorebar" id="scorebar">
      <div class="team" id="teamA">
        <div class="logo"><img id="logoA" alt="Team A logo" /></div>
        <div class="name" id="nameA">Home</div>
        <div class="score" id="scoreA">0</div>
        <div class="meta">
          <div class="pill"><span class="label">FALLI</span><span class="value" id="foulsA">0</span><span class="dot foul"></span></div>
          <div class="pill" id="bonusAwrap"><span class="dot bonus"></span><span class="label">BONUS</span></div>
          <div class="pill" id="possAwrap"><span class="dot poss"></span><span class="label">POSSESSO</span></div>
        </div>
      </div>

      <div class="center">
        <div class="clock" id="gameClock">12:00</div>
        <div class="center-meta">
          <div class="pill"><span class="label">TEMPO</span><span class="value" id="period">1</span></div>
          <div class="pill"><span class="label">Shot</span><span class="value" id="shotClock">24</span></div>
          <div class="pill"><span class="label">TIME OUT</span><span class="value" id="timeouts">7</span></div>
        </div>
      </div>

      <div class="team right" id="teamB">
        <div class="meta">
          <div class="pill" id="possBwrap"><span class="dot poss"></span><span class="label">POSSESSO</span></div>
          <div class="pill" id="bonusBwrap"><span class="dot bonus"></span><span class="label">BONUS</span></div>
          <div class="pill"><span class="label">FALLI</span><span class="value" id="foulsB">0</span><span class="dot foul"></span></div>
        </div>
        <div class="score" id="scoreB">0</div>
        <div class="name" id="nameB">Away</div>
        <div class="logo"><img id="logoB" alt="Team B logo" /></div>
      </div>
    </article>
  </div>

  <!-- Firebase (modular v10+) -->
  <script type="module">
    // ⬇️ INCOLLA QUI IL TUO CONFIG DI FIREBASE (lo stesso del controller)
    const firebaseConfig = {
 apiKey: "AIzaSyDxuUUK8xbO50mERK2hU6xxwgBW9tf10wI",
  authDomain: "anzio-scoreboard.firebaseapp.com",
  databaseURL: "https://anzio-scoreboard-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "anzio-scoreboard",
  storageBucket: "anzio-scoreboard.firebasestorage.app",
  messagingSenderId: "1070047467007",
  appId: "1:1070047467007:web:eebd383f3f45f7943483ca",
  measurementId: "G-HJB4DC7GN7"
    };
    const GAME_ID = new URLSearchParams(location.search).get('game') || 'anzio-scoreboard-3d8bb';

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const app = initializeApp(firebaseConfig);
    const db  = getDatabase(app);
    const stateRef = ref(db, `games/${GAME_ID}/state`);

    const $ = sel => document.querySelector(sel);
    const els = {
      nameA: $('#nameA'), nameB: $('#nameB'),
      logoA: $('#logoA'), logoB: $('#logoB'),
      scoreA: $('#scoreA'), scoreB: $('#scoreB'),
      foulsA: $('#foulsA'), foulsB: $('#foulsB'),
      bonusAwrap: $('#bonusAwrap'), bonusBwrap: $('#bonusBwrap'),
      possAwrap: $('#possAwrap'), possBwrap: $('#possBwrap'),
      period: $('#period'), timeouts: $('#timeouts'),
      gameClock: $('#gameClock'), shotClock: $('#shotClock')
    };

    const state = {
      nameA:'Home', nameB:'Away', logoA:'', logoB:'',
      scoreA:0, scoreB:0, foulsA:0, foulsB:0, bonusA:false, bonusB:false,
      period:1, timeouts:7, gameClockMS:12*60*1000, shotClock:24, poss:null
    };

    function fmtClock(ms){
      const neg = ms<0; const abs=Math.abs(ms);
      const m=Math.floor(abs/60000), s=Math.floor((abs%60000)/1000);
      const t=`${m}:${s.toString().padStart(2,'0')}`; return neg?`-${t}`:t;
    }
    function render(){
      els.nameA.textContent=state.nameA; els.nameB.textContent=state.nameB;
      els.scoreA.textContent=state.scoreA; els.scoreB.textContent=state.scoreB;
      els.foulsA.textContent=state.foulsA; els.foulsB.textContent=state.foulsB;
      els.period.textContent=state.period; els.timeouts.textContent=state.timeouts;
      els.shotClock.textContent=state.shotClock;
      els.logoA.src=state.logoA||''; els.logoB.src=state.logoB||'';
      els.bonusAwrap.style.opacity=state.bonusA?1:.35; els.bonusBwrap.style.opacity=state.bonusB?1:.35;
      els.possAwrap.style.opacity=state.poss==='A'?1:.3; els.possBwrap.style.opacity=state.poss==='B'?1:.3;
      els.gameClock.textContent=fmtClock(state.gameClockMS);
    }
    render();

    onValue(stateRef, (snap)=>{
      const v = snap.val();
      if(!v) return;
      Object.assign(state, v);
      render();
    });
  </script>
</body>
</html>
