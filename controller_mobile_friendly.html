<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Pro Scoreboard – Controller</title>
  <style>
    :root{
      --bg:#0e1117;            /* dark slate */
      --panel:#141923;         /* control panel */
      --accent:#5ee0ff;        /* cyan accent */
      --accent2:#80ff9f;       /* green accent */
      --muted:#8a93a6;         /* muted text */
      --danger:#ff5470;        /* red */
      --white:#f5f7fb;
    }
    html,body {
  height: 100%;
  margin: 0;
  color: var(--white);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Ubuntu, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: url('BACKGROUND.jpg') center/cover no-repeat fixed;
}


    /* Content above overlay */
    .wrap{ position:relative; z-index:1; display:grid; grid-template-columns: 1fr 1fr; gap:18px; padding:20px; max-width:1200px; margin:0 auto; }
    .card{ background:rgba(20,25,35,.88); border-radius:16px; padding:16px; box-shadow: 0 8px 30px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.06); }
    h2{ margin:0 0 12px; font-size:14px; letter-spacing:.6px; text-transform:uppercase; color:var(--muted); }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-bottom:8px; }
    input[type="text"], input[type="number"], input[type="time"]{ background:#0e1420; border:1px solid rgba(255,255,255,.1); color:var(--white); padding:10px 12px; border-radius:10px; outline:none; font-weight:600; min-width:0; }
    input[type="file"]{ color:var(--muted); }
    button{ background:linear-gradient(135deg, #1c2433, #121826); border:1px solid rgba(255,255,255,.08); color:var(--white); padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; box-shadow: 0 4px 14px rgba(0,0,0,.25); touch-action:manipulation; -webkit-tap-highlight-color: transparent; }
    button:hover{ filter:brightness(1.08); }
    button:active{ transform:translateY(1px); }
    .btn-danger{ background:linear-gradient(135deg, #3a1520, #210b12); border-color:rgba(255,84,112,.35); }
    .btn-accent{ background:linear-gradient(135deg, #12313a, #0a1e25); border-color:rgba(94,224,255,.4); }
    .grid-2{ display:grid; grid-template-columns: repeat(2,1fr); gap:12px; }
    .tiny{ font-size:12px; color:var(--muted); }

    /* ======= Mobile-friendly layout ======= */
    @media (max-width: 1024px){
      .wrap{ grid-template-columns: 1fr; max-width: 880px; padding:16px; }
      .card{ padding:14px; }
    }

    /* Phones landscape */
    @media (max-width: 820px) and (orientation: landscape){
      .wrap{ grid-template-columns: 1fr; gap:14px; padding:14px; max-width: 100%; }
      .row{ gap:8px; }
      button{ padding:12px 14px; font-size:16px; border-radius:14px; }
      input[type="text"], input[type="number"], input[type="time"]{ padding:12px 14px; font-size:16px; border-radius:12px; }
      .grid-2{ grid-template-columns: 1fr 1fr; gap:10px; }
      /* sticky clock for quick access */
      .card:nth-of-type(2){ position:sticky; top:0; z-index:5; }
    }

    /* Phones portrait */
    @media (max-width: 480px){
      .wrap{ grid-template-columns: 1fr; gap:12px; padding:12px; max-width: 100%; }
      .card{ padding:12px; }
      h2{ font-size:15px; }
      .row{ gap:8px; }
      .row > button{ flex:1 1 48%; min-width:140px; }
      .row > input[type="text"],
      .row > input[type="number"],
      .row > input[type="time"]{ flex:1 1 48%; min-width:140px; }
      input[type="text"], input[type="number"], input[type="time"]{ padding:14px 16px; font-size:17px; border-radius:14px; }
      button{ padding:14px 16px; font-size:17px; border-radius:14px; }
      .grid-2{ grid-template-columns: 1fr; gap:10px; }
      .card:nth-of-type(2){ position:sticky; top:env(safe-area-inset-top, 0); z-index:5; }
    }
  </style>
</head>
<body>
  <header class="header-title">
    ANZIO BASKET FANS WEBTV – SCORE-BOARD CONTROLLER
  </header>  
<div class="wrap">
    <div class="card">
      <h2>Teams</h2>
      <div class="row">
        <input type="text" id="inNameA" placeholder="Home team name" />
        <input type="file" id="inLogoA" accept="image/*" />
      </div>
      <div class="row">
        <input type="text" id="inNameB" placeholder="Away team name" />
        <input type="file" id="inLogoB" accept="image/*" />
      </div>
      <div class="row">
        <button id="swapTeams">Swap Sides</button>
        <button id="resetLogos">Clear Logos</button>
      </div>
    </div>

    <div class="card">
      <h2>Game Clock & Shot Clock</h2>
      <div class="row">
        <button id="clkStart" class="btn-accent">Start</button>
        <button id="clkStop">Stop</button>
        <button id="clkReset">Reset 12:00</button>
        <input type="text" id="clkSet" placeholder="Set mm:ss" style="width:120px" />
        <button id="clkApply">Apply</button>
      </div>
      <div class="row">
        <button id="shotReset">Shot 24</button>
        <button id="shot14">Shot 14</button>
        <input type="number" id="shotSet" min="1" max="99" value="24" style="width:80px"/>
        <button id="shotApply">Apply</button>
      </div>
      <div class="tiny">Shortcuts: Space = Start/Stop · R = Shot 24 · F = Shot 14 · +/- = Shot ±1</div>
    </div>

    <div class="card">
      <h2>Scores</h2>
      <div class="grid-2">
        <div>
          <div class="row"><button data-delta="-1" data-target="A" class="btn-danger">Home -1</button><button data-delta="1" data-target="A">Home +1</button><button data-delta="2" data-target="A">+2</button><button data-delta="3" data-target="A">+3</button></div>
        </div>
        <div>
          <div class="row"><button data-delta="-1" data-target="B" class="btn-danger">Away -1</button><button data-delta="1" data-target="B">Away +1</button><button data-delta="2" data-target="B">+2</button><button data-delta="3" data-target="B">+3</button></div>
        </div>
      </div>
      <div class="row"><button id="resetScores" class="btn-danger">Reset Scores</button></div>
    </div>

    <div class="card">
      <h2>Period & Timeouts</h2>
      <div class="row">
        <button id="perDec">Period -</button><span class="tiny">Current: <strong id="periodView">1</strong></span><button id="perInc">Period +</button>
      </div>
      <div class="row">
        <button id="toDec">TO -</button><span class="tiny">Current: <strong id="timeoutsView">7</strong></span><button id="toInc">TO +</button>
      </div>
    </div>

    <div class="card">
      <h2>Fouls & Bonus</h2>
      <div class="grid-2">
        <div>
          <div class="row"><span class="tiny">Home Fouls: <strong id="foulsAView">0</strong></span></div>
          <div class="row"><button data-foul="A" data-delta="-1" class="btn-danger">-1</button><button data-foul="A" data-delta="1">+1</button><button id="bonusAToggle">Toggle Bonus</button></div>
        </div>
        <div>
          <div class="row"><span class="tiny">Away Fouls: <strong id="foulsBView">0</strong></span></div>
          <div class="row"><button data-foul="B" data-delta="-1" class="btn-danger">-1</button><button data-foul="B" data-delta="1">+1</button><button id="bonusBToggle">Toggle Bonus</button></div>
        </div>
      </div>
      <div class="row"><button id="resetFouls" class="btn-danger">Reset Fouls</button></div>
    </div>

    <div class="card">
      <h2>Possession Arrow</h2>
      <div class="row">
        <button id="possA">Home Possession</button>
        <button id="possB">Away Possession</button>
        <button id="possClear" class="btn-danger">Clear</button>
      </div>
    </div>

    <div class="card">
      <h2>Utilities</h2>
      <div class="row">
        <button id="saveState">Save State</button>
        <button id="loadState">Load State</button>
        <button id="resetAll" class="btn-danger">Reset All</button>
      </div>
      <div class="tiny">Open the scoreboard overlay page separately. Both pages must be open for live control. They sync via BroadcastChannel("pro-scoreboard").</div>
    </div>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const chan = ('BroadcastChannel' in window) ? new BroadcastChannel('pro-scoreboard') : null;
  const broadcast = () => { try{ chan && chan.postMessage({type:'state', state}); }catch(e){} };

  const state = {
    nameA:'Home', nameB:'Away', logoA:'', logoB:'',
    scoreA:0, scoreB:0, foulsA:0, foulsB:0, bonusA:false, bonusB:false,
    period:1, timeouts:7, gameClockMS:12*60*1000, gameRunning:false, shotClock:24, poss:null
  };

  const c = {
    inNameA: $('#inNameA'), inNameB: $('#inNameB'), inLogoA: $('#inLogoA'), inLogoB: $('#inLogoB'),
    swapTeams: $('#swapTeams'), resetLogos: $('#resetLogos'),
    clkStart: $('#clkStart'), clkStop: $('#clkStop'), clkReset: $('#clkReset'), clkSet: $('#clkSet'), clkApply: $('#clkApply'),
    shotReset: $('#shotReset'), shot14: $('#shot14'), shotSet: $('#shotSet'), shotApply: $('#shotApply'),
    perDec: $('#perDec'), perInc: $('#perInc'), toDec: $('#toDec'), toInc: $('#toInc'),
    periodView: $('#periodView'), timeoutsView: $('#timeoutsView'),
    resetScores: $('#resetScores'), resetFouls: $('#resetFouls'),
    bonusAToggle: $('#bonusAToggle'), bonusBToggle: $('#bonusBToggle'),
    foulsAView: $('#foulsAView'), foulsBView: $('#foulsBView'),
    possA: $('#possA'), possB: $('#possB'), possClear: $('#possClear'),
    saveState: $('#saveState'), loadState: $('#loadState'), resetAll: $('#resetAll')
  };

  function renderToViews(){
    c.inNameA.value = state.nameA; c.inNameB.value = state.nameB;
    c.periodView.textContent = state.period; c.timeoutsView.textContent = state.timeouts;
    c.shotSet.value = state.shotClock;
    c.foulsAView.textContent = state.foulsA; c.foulsBView.textContent = state.foulsB;
  }

  // Timers – controller drives the clocks
  let lastTick = 0; let rafId = null; const SHOT_INTERVAL = 1000; let lastShotTick = 0;
  function tick(ts){
    if(!lastTick) lastTick = ts; if(!lastShotTick) lastShotTick = ts;
    const dt = ts - lastTick; lastTick = ts;
    if(state.gameRunning){
      state.gameClockMS = Math.max(0, state.gameClockMS - dt);
      if(ts - lastShotTick >= SHOT_INTERVAL){
        state.shotClock = Math.max(0, state.shotClock - 1);
        lastShotTick = ts;
      }
      broadcast();
    }
    rafId = requestAnimationFrame(tick);
  }
  rafId = requestAnimationFrame(tick);

  // Inputs
  function handleLogo(file, key){ if(!file) return; const r=new FileReader(); r.onload=()=>{ state[key]=r.result; broadcast(); }; r.readAsDataURL(file); }
  c.inNameA.addEventListener('input', e=>{ state.nameA = e.target.value || 'Home'; broadcast(); });
  c.inNameB.addEventListener('input', e=>{ state.nameB = e.target.value || 'Away'; broadcast(); });
  c.inLogoA.addEventListener('change', e=>handleLogo(e.target.files[0], 'logoA'));
  c.inLogoB.addEventListener('change', e=>handleLogo(e.target.files[0], 'logoB'));

  c.swapTeams.addEventListener('click', ()=>{
    [state.nameA, state.nameB] = [state.nameB, state.nameA];
    [state.logoA, state.logoB] = [state.logoB, state.logoA];
    [state.scoreA, state.scoreB] = [state.scoreB, state.scoreA];
    [state.foulsA, state.foulsB] = [state.foulsB, state.foulsA];
    state.poss = state.poss==='A'?'B': state.poss==='B'?'A': null;
    broadcast(); renderToViews();
  });
  c.resetLogos.addEventListener('click', ()=>{ state.logoA=''; state.logoB=''; broadcast(); });

  // Clock controls
  c.clkStart.addEventListener('click', ()=>{ state.gameRunning=true; lastTick=0; lastShotTick=0; broadcast(); });
  c.clkStop.addEventListener('click', ()=>{ state.gameRunning=false; broadcast(); });
  c.clkReset.addEventListener('click', ()=>{ state.gameClockMS=12*60*1000; state.shotClock=24; state.gameRunning=false; broadcast(); renderToViews(); });
  c.clkApply.addEventListener('click', ()=>{ const m=/^([0-9]{1,2}):([0-5][0-9])$/.exec(c.clkSet.value.trim()); if(m){ state.gameClockMS=(parseInt(m[1])*60+parseInt(m[2]))*1000; broadcast(); }});

  // Shot clock
  c.shotReset.addEventListener('click', ()=>{ state.shotClock=24; broadcast(); renderToViews(); });
  c.shot14.addEventListener('click', ()=>{ state.shotClock=14; broadcast(); renderToViews(); });
  c.shotApply.addEventListener('click', ()=>{ const v=Math.max(1, Math.min(99, parseInt(c.shotSet.value||24))); state.shotClock=v; broadcast(); renderToViews(); });

  // Scores & Fouls
  document.addEventListener('click', e=>{
    const sb = e.target.closest('button[data-delta]');
    if(sb){ const d=parseInt(sb.dataset.delta); const t=sb.dataset.target; const key=t==='A'?'scoreA':'scoreB'; state[key]=Math.max(0, state[key]+d); broadcast(); }
    const fb = e.target.closest('button[data-foul]');
    if(fb){ const team=fb.dataset.foul; const d=parseInt(fb.dataset.delta); const key=team==='A'?'foulsA':'foulsB'; state[key]=Math.max(0, state[key]+d); broadcast(); renderToViews(); }
  });
  c.resetScores?.addEventListener('click', ()=>{ state.scoreA=0; state.scoreB=0; broadcast(); });
  c.resetFouls.addEventListener('click', ()=>{ state.foulsA=0; state.foulsB=0; state.bonusA=false; state.bonusB=false; broadcast(); renderToViews(); });

  // Period & TO
  c.perDec.addEventListener('click', ()=>{ state.period=Math.max(1, state.period-1); broadcast(); renderToViews(); });
  c.perInc.addEventListener('click', ()=>{ state.period=Math.min(9, state.period+1); broadcast(); renderToViews(); });
  c.toDec.addEventListener('click', ()=>{ state.timeouts=Math.max(0, state.timeouts-1); broadcast(); renderToViews(); });
  c.toInc.addEventListener('click', ()=>{ state.timeouts=Math.min(10, state.timeouts+1); broadcast(); renderToViews(); });

  // Bonus & Possession
  c.bonusAToggle.addEventListener('click', ()=>{ state.bonusA=!state.bonusA; broadcast(); });
  c.bonusBToggle.addEventListener('click', ()=>{ state.bonusB=!state.bonusB; broadcast(); });
  c.possA.addEventListener('click', ()=>{ state.poss='A'; broadcast(); });
  c.possB.addEventListener('click', ()=>{ state.poss='B'; broadcast(); });
  c.possClear.addEventListener('click', ()=>{ state.poss=null; broadcast(); });

  // Save/Load
  c.saveState.addEventListener('click', ()=>{ localStorage.setItem('pro-scoreboard', JSON.stringify(state)); alert('Saved.'); });
  c.loadState.addEventListener('click', ()=>{ try{ const s=JSON.parse(localStorage.getItem('pro-scoreboard')||'{}'); Object.assign(state,s); broadcast(); renderToViews(); }catch(e){} });
  c.resetAll.addEventListener('click', ()=>{
    Object.assign(state, { nameA:'Home', nameB:'Away', logoA:'', logoB:'', scoreA:0, scoreB:0, foulsA:0, foulsB:0, bonusA:false, bonusB:false, period:1, timeouts:7, gameClockMS:12*60*1000, gameRunning:false, shotClock:24, poss:null });
    broadcast(); renderToViews();
  });

  // Keyboard shortcuts
  window.addEventListener('keydown', (e)=>{
    if(e.target && ['INPUT','TEXTAREA'].includes(e.target.tagName)) return; // don't intercept typing
    if(e.code==='Space'){ e.preventDefault(); state.gameRunning=!state.gameRunning; lastTick=0; lastShotTick=0; broadcast(); }
    if(e.key==='r' || e.key==='R'){ state.shotClock=24; broadcast(); renderToViews(); }
    if(e.key==='f' || e.key==='F'){ state.shotClock=14; broadcast(); renderToViews(); }
    if(e.key==='+'){ state.shotClock=Math.min(99, state.shotClock+1); broadcast(); renderToViews(); }
    if(e.key==='-'){ state.shotClock=Math.max(0, state.shotClock-1); broadcast(); renderToViews(); }
  });

  // Initialize
  renderToViews();
})();
</script>
</body>
</html>
